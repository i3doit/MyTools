<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>支票金额转换器-艾兜兜儿</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Noto Sans SC', sans-serif;
        }

        body {
            background: linear-gradient(120deg, #e0f7fa 0%, #c8e6c9 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stats {
            text-align: center;
            color: #666;
            margin: 10px 0;
        }

        /* 新增提示条样式 */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            animation: fade 2s;
            display: none;
        }

        @keyframes fade {
            0% {opacity: 0;}
            20% {opacity: 1;}
            80% {opacity: 1;}
            100% {opacity: 0;}
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>支票金额转换器</h1>
        
        <div class="input-group">
            <input type="number" id="amount" placeholder="输入阿拉伯数字金额">
            <button onclick="convert()">转换</button>
            <button onclick="resetInput()" style="background:#ef5350">重置</button>
        </div>

        <table>
            <!-- 表格内容同上 -->
        </table>

        <div class="stats">
            <span>今日访问量：<span id="todayCount">0</span></span>
            <span style="margin-left:20px">总访问量：<span id="totalCount">0</span></span>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // 初始化本地存储
        let records = JSON.parse(localStorage.getItem('conversionRecords')) || [];
        let currentPage = 1;
        const pageSize = 10;

        // 访问量统计
        function updateStatistics() {
            const today = new Date().toDateString();
            const ip = localStorage.getItem('lastIPDate')?.split('|')[0] || 'unknown';
            
            // 更新总访问量
            let total = parseInt(localStorage.getItem('totalVisits')) || 0;
            localStorage.setItem('totalVisits', ++total);
            
            // 更新今日访问量
            let visits = JSON.parse(localStorage.getItem('dailyVisits')) || {};
            if (!visits[today]) visits[today] = new Set();
            visits[today].add(ip);
            localStorage.setItem('dailyVisits', JSON.stringify(visits));
            
            // 显示统计数据
            document.getElementById('todayCount').textContent = visits[today]?.size || 0;
            document.getElementById('totalCount').textContent = total;
        }

        // 获取IP地址
        async function getIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                const today = new Date().toDateString();
                const lastRecord = localStorage.getItem('lastIPDate');
                
                if (!lastRecord || lastRecord.split('|')[1] !== today) {
                    localStorage.setItem('lastIPDate', `${data.ip}|${today}`);
                }
                return data.ip;
            } catch {
                return 'unknown';
            }
        }

        // 数字转中文大写
        function toChinese(num) {
            const chnNums = ['零','壹','贰','叁','肆','伍','陆','柒','捌','玖'];
            const chnUnits = ['','拾','佰','仟','万','拾万','佰万','仟万','亿'];
            
            let integer = Math.floor(num);
            let decimal = Math.round((num - integer) * 100);
            let result = '';

            // 整数部分转换
            let unitIndex = 0;
            while (integer > 0) {
                let n = integer % 10;
                result = chnNums[n] + (n ? chnUnits[unitIndex] : '') + result;
                integer = Math.floor(integer / 10);
                unitIndex++;
            }

            // 小数部分转换
            if (decimal > 0) {
                result += chnNums[Math.floor(decimal / 10)] + '角';
                result += chnNums[decimal % 10] + '分';
            } else {
                result += '整';
            }

            return '人民币' + result.replace(/零+/g, '零') + '元';
        }

        // 数字转英文大写
        function toEnglish(num) {
            const units = ['','Thousand','Million','Billion'];
            const nums = ['','One','Two','Three','Four','Five','Six','Seven','Eight','Nine'];
            
            let result = 'SAY US DOLLARS ';
            let integer = Math.floor(num);
            let cents = Math.round((num - integer) * 100);
            
            // 整数部分转换
            let unitIndex = 0;
            while (integer > 0) {
                let chunk = integer % 1000;
                if (chunk > 0) {
                    result = convertChunk(chunk) + units[unitIndex] + ' ' + result;
                }
                integer = Math.floor(integer / 1000);
                unitIndex++;
            }

            // 美分转换
            result += 'AND ' + cents + '/100';

            return result.trim() + ' ONLY';

            function convertChunk(n) {
                // 三位数转换逻辑
                // 实现细节略...
            }
        }

        // 显示提示条
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 2000);
        }

        // 重置功能
        function resetInput() {
            document.getElementById('amount').value = '';
        }

        // 页面初始化
        window.onload = async () => {
            await getIP();
            updateStatistics();
            renderTable();
            renderPagination();
        }
    </script>
</body>
</html>
