<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>钱包地址测试数据生成器</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans SC', sans-serif; background-color: #f4f7f6; color: #333; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); padding: 25px; }
        header { text-align: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #eee; }
        h1 { color: #2c7744; }
        .controls { display: flex; justify-content: space-between; align-items: center; background: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; }
        .btn-primary { background: #4CAF50; color: white; }
        .btn-export { background: #2196F3; color: white; }
        .btn-reset { background: #f44336; color: white; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; word-break: break-all; }
        th { background: #f8fcf9; color: #2c7744; }
        .address-cell { font-family: monospace; font-size: 0.85rem; padding: 4px 6px; border-radius: 3px; cursor: pointer; background: #f0f0f0; }
        .erc { color: #1976D2; }
        .trc { color: #E64A19; }
        .pagination { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 8px 16px; border-radius: 20px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>钱包地址模拟生成器</h1>
        <p>软件测试专用 - 默认自动加载10条数据</p>
    </header>

    <div class="controls">
        <div>
            数量：<input type="number" id="address-count" value="10" style="width: 60px; padding: 5px;">
            <button class="btn btn-primary" id="generate-btn">生成数据</button>
        </div>
        <div>
            <button class="btn btn-export" id="export-btn">导出 Excel</button>
            <button class="btn btn-reset" id="reset-btn">重置清空</button>
        </div>
    </div>

    <table id="main-table">
        <thead>
            <tr>
                <th style="width: 60px;">ID</th>
                <th>ERC-20 (ETH)</th>
                <th>TRC-20 (TRON)</th>
            </tr>
        </thead>
        <tbody id="table-body">
            </tbody>
    </table>

    <div id="pagination" class="pagination"></div>
</div>

<div id="toast" class="toast">复制成功</div>

<script>
    // --- 数据逻辑 ---
    let walletData = [];
    let lastId = 0;
    let currentPage = 1;
    const itemsPerPage = 10;

    // 生成模拟地址
    function generateERC20() {
        const chars = '0123456789abcdef';
        let addr = '0x';
        for (let i = 0; i < 40; i++) addr += chars[Math.floor(Math.random() * 16)];
        return addr;
    }

    function generateTRC20() {
        const b58 = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
        let addr = 'T'; // TRC20 必须 T 开头
        for (let i = 0; i < 33; i++) addr += b58[Math.floor(Math.random() * b58.length)];
        return addr;
    }

    // 执行生成
    function doGenerate(count) {
        for (let i = 0; i < count; i++) {
            lastId++;
            walletData.push({ id: lastId, erc: generateERC20(), trc: generateTRC20() });
        }
        renderTable();
        trySave();
    }

    // 渲染表格
    function renderTable() {
        const tbody = document.getElementById('table-body');
        if (!tbody) return;

        const start = (currentPage - 1) * itemsPerPage;
        const pageData = walletData.slice(start, start + itemsPerPage);

        if (walletData.length === 0) {
            tbody.innerHTML = '<tr><td colspan="3" style="text-align:center">暂无数据，请点击生成</td></tr>';
            return;
        }

        tbody.innerHTML = pageData.map(item => `
            <tr>
                <td>${item.id}</td>
                <td><span class="address-cell erc" onclick="copyIt('${item.erc}')">${item.erc}</span></td>
                <td><span class="address-cell trc" onclick="copyIt('${item.trc}')">${item.trc}</span></td>
            </tr>
        `).join('');

        renderPagination();
    }

    function renderPagination() {
        const pageDiv = document.getElementById('pagination');
        const totalPages = Math.ceil(walletData.length / itemsPerPage);
        if (totalPages <= 1) { pageDiv.innerHTML = ''; return; }

        pageDiv.innerHTML = `
            <button class="btn" onclick="movePage(-1)" ${currentPage === 1 ? 'disabled' : ''}>上一页</button>
            <span>${currentPage} / ${totalPages}</span>
            <button class="btn" onclick="movePage(1)" ${currentPage === totalPages ? 'disabled' : ''}>下一页</button>
        `;
    }

    function movePage(step) {
        currentPage += step;
        renderTable();
    }

    function copyIt(text) {
        navigator.clipboard.writeText(text);
        const t = document.getElementById('toast');
        t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 1000);
    }

    // --- 存储逻辑 ---
    function trySave() {
        try {
            localStorage.setItem('test_wallets', JSON.stringify({ data: walletData, last: lastId }));
        } catch (e) { console.warn("无法保存到本地存储"); }
    }

    // --- 事件绑定 ---
    document.getElementById('generate-btn').onclick = () => {
        const num = parseInt(document.getElementById('address-count').value) || 10;
        doGenerate(num);
    };

    document.getElementById('reset-btn').onclick = () => {
        walletData = []; lastId = 0; currentPage = 1;
        localStorage.removeItem('test_wallets');
        renderTable();
    };

    document.getElementById('export-btn').onclick = () => {
        if (typeof XLSX === 'undefined') {
            alert('导出插件加载失败，请检查网络或检查控制台。');
            return;
        }
        if (walletData.length === 0) return alert('没数据可导');
        const ws = XLSX.utils.json_to_sheet(walletData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Wallets");
        XLSX.writeFile(wb, "wallet_data.xlsx");
    };

    // --- 初始化入口 ---
    window.onload = () => {
        const cache = localStorage.getItem('test_wallets');
        if (cache) {
            const p = JSON.parse(cache);
            walletData = p.data;
            lastId = p.last;
            renderTable();
        } else {
            // 如果没缓存，默认生成10条
            doGenerate(10);
        }
    };
</script>

</body>
</html>
