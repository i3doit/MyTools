<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ™ºèƒ½ä»£ç è¿è¡Œå™¨ - è‰¾å…œå…œå„¿</title>
    <style>
        :root {
            --primary: #4CAF50;
            --accent: #007acc;
            --warning: #ff9800;
            --bg: #1a1a1a;
            --panel: #252526;
            --text: #ccc;
            --border: #333;
        }

        .theme-light { --bg: #fff; --panel: #f0f0f0; --text: #333; --border: #ddd; }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; width: 100%; overflow: hidden; background: #000; font-family: -apple-system, sans-serif; }

        /* ä½¿ç”¨ Grid å¸ƒå±€ç¡®ä¿åº•éƒ¨ä¸è¢«é®æŒ¡ */
        .app-grid {
            display: grid;
            grid-template-rows: 50px 1fr auto; /* å¤´éƒ¨, ä¸»ä½“, åº•éƒ¨ */
            height: 100vh;
            background: var(--bg);
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            background: var(--panel);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
            border-bottom: 1px solid var(--border);
        }
        .nav-icons { display: flex; gap: 8px; }
        .icon-btn {
            background: none; border: none; cursor: pointer; color: var(--text);
            display: flex; flex-direction: column; align-items: center; font-size: 16px;
        }
        .icon-btn label { font-size: 9px; margin-top: 2px; }

        /* ä¸»ä½“åŒºåŸŸ */
        main { display: flex; flex-direction: column; overflow: hidden; }
        
        /* ç«–å±æ¯”ä¾‹ï¼šä»£ç  25% | é¢„è§ˆ 75% */
        #editor-container { height: 25%; display: flex; border-bottom: 1px solid var(--border); background: var(--bg); position: relative; }
        #preview-container { height: 75%; background: #fff; }
        
        .line-num { width: 30px; padding-top: 5px; color: #555; font-size: 10px; text-align: center; font-family: monospace; background: rgba(0,0,0,0.05); }
        textarea { flex: 1; background: transparent; color: var(--text); border: none; padding: 10px; resize: none; outline: none; font-size: 13px; font-family: monospace; }
        iframe { width: 100%; height: 100%; border: none; }

        /* åº•éƒ¨åŒºåŸŸ - ç¡®ä¿å¯è§ */
        footer {
            background: var(--panel);
            border-top: 1px solid var(--border);
            padding: 8px 10px calc(8px + env(safe-area-inset-bottom));
            text-align: center;
        }
        .ad-banner {
            background: linear-gradient(90deg, transparent, rgba(255,152,0,0.2), transparent);
            padding: 6px; border-radius: 4px; margin-bottom: 5px;
        }
        .ad-banner a { color: var(--warning); text-decoration: none; font-size: 12px; font-weight: bold; }
        .author-info { font-size: 11px; color: var(--text); opacity: 0.8; }
        .wx-btn { color: var(--accent); font-weight: bold; text-decoration: underline; }

        /* å¼¹çª—æ ·å¼ */
        #modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 999; align-items: center; justify-content: center;
        }
        .modal-card {
            background: white; padding: 20px; border-radius: 12px; width: 280px; text-align: center;
        }
        #qr-canvas { display: none; } /* éšè—åŸç”Ÿç”»å¸ƒ */
        #qr-img { width: 180px; height: 180px; margin: 10px 0; border: 1px solid #eee; }
        .download-btn {
            background: var(--primary); color: white; border: none; padding: 10px 20px;
            border-radius: 6px; font-weight: bold; margin-top: 10px; width: 100%; cursor: pointer;
        }

        /* æç¤ºæ¡† */
        #toast { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 16px; border-radius: 20px; font-size: 12px; display: none; }

        /* æ¨ªå±é€‚é… */
        @media (min-width: 768px) {
            main { flex-direction: row; }
            #editor-container { height: 100%; width: 40%; border-bottom: none; border-right: 1px solid var(--border); }
            #preview-container { height: 100%; width: 60%; }
        }
    </style>
</head>
<body class="theme-dark">

<div class="app-grid">
    <header>
        <div style="color:white; font-size:14px; font-weight:bold;">Runner <span>Pro</span></div>
        <div class="nav-icons">
            <button class="icon-btn" onclick="doPaste()"><span>ğŸ“‹</span><label id="lang-paste">ç²˜è´´</label></button>
            <button class="icon-btn" onclick="openShare()"><span>ğŸ“¤</span><label id="lang-share">åˆ†äº«</label></button>
            <button class="icon-btn" onclick="toggleLang()"><span>ğŸŒ</span><label id="lang-curr">ä¸­æ–‡</label></button>
            <button class="icon-btn" onclick="clearCode()"><span>ğŸ—‘ï¸</span><label id="lang-clear">æ¸…ç©º</label></button>
            <button class="icon-btn" style="color:var(--primary)" onclick="runCode()"><span>â–¶</span><label id="lang-run">è¿è¡Œ</label></button>
        </div>
    </header>

    <main>
        <div id="editor-container">
            <div class="line-num" id="line-box">1</div>
            <textarea id="editor" spellcheck="false" placeholder="Code here..."></textarea>
        </div>
        <div id="preview-container">
            <iframe id="preview"></iframe>
        </div>
    </main>

    <footer>
        <div class="ad-banner">
            <a href="#" id="ad-text">ğŸ”¥ è‰¾å…œå…œå„¿ä¸“å±ç¦åˆ©ï¼šäº‘æœåŠ¡å™¨ç‰¹æƒ å…¥å£ &gt;</a>
        </div>
        <div class="author-info">
            <span id="lang-author">ä½œè€…</span>: è‰¾å…œå…œå„¿ | WeChat: <span class="wx-btn" onclick="copyWx()">857023577</span>
        </div>
    </footer>
</div>

<div id="modal-overlay" onclick="this.style.display='none'">
    <div class="modal-card" onclick="event.stopPropagation()">
        <h3 id="modal-title" style="color:#333">åˆ†äº«å·¥å…·</h3>
        <img id="qr-img" src="" alt="äºŒç»´ç ">
        <p style="font-size: 12px; color: #666;">æ‰«ææˆ–ä¸‹è½½ä¸‹æ–¹äºŒç»´ç å›¾ç‰‡</p>
        <button class="download-btn" onclick="downloadQr()" id="lang-download">ä¿å­˜åˆ°ç›¸å†Œ</button>
    </div>
</div>

<div id="toast"></div>

<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>

<script>
    const editor = document.getElementById('editor');
    const preview = document.getElementById('preview');
    const lineBox = document.getElementById('line-box');
    const toast = document.getElementById('toast');

    const i18n = {
        'zh': { paste:'ç²˜è´´', share:'åˆ†äº«', clear:'æ¸…ç©º', run:'è¿è¡Œ', author:'ä½œè€…', dl:'ä¿å­˜åˆ°ç›¸å†Œ', ad:'ğŸ”¥ è‰¾å…œå…œå„¿ä¸“å±ï¼šäº‘æœåŠ¡å™¨ç‰¹æƒ å…¥å£ >' },
        'en': { paste:'Paste', share:'Share', clear:'Clear', run:'Run', author:'Author', dl:'Save Image', ad:'ğŸ”¥ Ad: Exclusive Cloud Server Deal >' }
    };

    let curLang = 'zh';

    const defaultDoc = `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:sans-serif;text-align:center;padding:20px;color:#333}h2{color:#4CAF50}.info{background:#f9f9f9;padding:15px;border-radius:8px;border:1px solid #eee}</style></head><body><h2>ğŸš€ æ™ºèƒ½è¿è¡Œå™¨ V5.0</h2><div class="info"><p><b>ä½œè€…ï¼š</b>è‰¾å…œå…œå„¿</p><p><b>å¾®ä¿¡ï¼š</b>857023577</p><p>ç‚¹å‡»ä¸Šæ–¹<b>åˆ†äº«</b>å¯ä¿å­˜åç‰‡</p></div></body></html>`;

    function init() {
        editor.value = localStorage.getItem('code_v5') || defaultDoc;
        updateLines();
        runCode();
        updateUI();
    }

    function toggleLang() {
        curLang = curLang === 'zh' ? 'en' : 'zh';
        updateUI();
    }

    function updateUI() {
        const d = i18n[curLang];
        document.getElementById('lang-paste').innerText = d.paste;
        document.getElementById('lang-share').innerText = d.share;
        document.getElementById('lang-clear').innerText = d.clear;
        document.getElementById('lang-run').innerText = d.run;
        document.getElementById('lang-author').innerText = d.author;
        document.getElementById('lang-download').innerText = d.dl;
        document.getElementById('ad-text').innerText = d.ad;
        document.getElementById('lang-curr').innerText = curLang === 'zh' ? 'ä¸­æ–‡' : 'English';
    }

    function runCode() {
        const doc = preview.contentDocument || preview.contentWindow.document;
        doc.open();
        doc.write('<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">');
        doc.write(editor.value);
        doc.close();
    }

    async function doPaste() {
        try {
            const text = await navigator.clipboard.readText();
            if(text) { editor.value = text; updateLines(); runCode(); showToast("OK"); }
        } catch(e) { showToast("Error: Manually Paste"); }
    }

    function clearCode() {
        editor.value = ''; updateLines(); runCode(); showToast("Cleared");
    }

    // åˆ†äº«ä¸ä¸‹è½½åŠŸèƒ½
    function openShare() {
        const url = window.location.href;
        QRCode.toDataURL(url, { width: 400, margin: 2 }, function (err, url) {
            if (err) return;
            document.getElementById('qr-img').src = url;
            document.getElementById('modal-overlay').style.display = 'flex';
        });
    }

    function downloadQr() {
        const link = document.createElement('a');
        link.download = 'aidoudou-share.png';
        link.href = document.getElementById('qr-img').src;
        link.click();
        showToast("Starting Download...");
    }

    function copyWx() {
        navigator.clipboard.writeText('857023577').then(() => showToast("Copied"));
    }

    function showToast(m) {
        toast.innerText = m; toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', 1500);
    }

    function updateLines() {
        const lines = editor.value.split('\n').length;
        let h = ''; for(let i=1; i<=lines; i++) h += i + '<br>';
        lineBox.innerHTML = h;
    }

    editor.addEventListener('input', () => {
        updateLines();
        localStorage.setItem('code_v5', editor.value);
    });

    editor.addEventListener('scroll', () => { lineBox.scrollTop = editor.scrollTop; });

    init();
</script>
</body>
</html>
