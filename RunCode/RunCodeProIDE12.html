<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>AiDouDou Code Runner - æ‰‹æœºç«¯å®æ—¶ä»£ç ç¼–è¾‘å™¨</title>
    <meta name="description" content="è‰¾å…œå…œå„¿å‡ºå“ï¼šæ”¯æŒ HTML/CSS/JS å®æ—¶é¢„è§ˆã€ä¸­è‹±åŒè¯­åˆ‡æ¢ã€ä¸€é”®ç”Ÿæˆé«˜æ¸…åç‰‡å¹¶ä¸‹è½½ç›¸å†Œã€‚ä¸“ä¸º iOS å’Œå®‰å“æµè§ˆå™¨ä¼˜åŒ–ã€‚">
    <meta name="keywords" content="ä»£ç ç¼–è¾‘å™¨, ç§»åŠ¨ç«¯ç¼–ç¨‹, è‰¾å…œå…œå„¿, Code Runner, åœ¨çº¿é¢„è§ˆ, ç¨‹åºå‘˜å·¥å…·">
    <meta name="author" content="è‰¾å…œå…œå„¿ (AiDouDou)">
    <link rel="canonical" href="https://i3doit.github.io/MyTools/RunCode.html" />
    
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <style>
        :root {
            --primary: #4CAF50;
            --accent: #007acc;
            --warning: #ff9800;
            --bg: #1e1e1e; /* æ¢å¤æ·±è‰²èƒŒæ™¯ */
            --panel: #252526;
            --text: #d4d4d4;
            --border: #333333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        /* ä¿®å¤ç§»åŠ¨ç«¯æµè§ˆå™¨è§†å£é«˜åº¦é—®é¢˜çš„å…³é”® */
        html, body { 
            height: 100%; 
            width: 100%; 
            overflow: hidden; 
            background-color: #000;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            /* é€‚é…è‹¹æœ/è°·æ­Œæµè§ˆå™¨å·¥å…·æ é®æŒ¡ */
            height: 100vh; 
            height: 100svh; 
            background: var(--bg);
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            height: 54px; 
            background: var(--panel); 
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 12px; flex-shrink: 0;
            z-index: 100;
        }
        .logo { color: #fff; font-size: 15px; font-weight: bold; letter-spacing: 0.5px; }
        .logo i { color: var(--primary); font-style: normal; font-size: 10px; border: 1px solid; padding: 0 3px; border-radius: 3px; margin-left: 5px; vertical-align: middle; }

        .nav-icons { display: flex; gap: 14px; }
        .icon-btn {
            background: none; border: none; cursor: pointer; color: var(--text);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .icon-btn span { font-size: 19px; margin-bottom: 2px; }
        .icon-btn label { font-size: 10px; cursor: pointer; color: #aaa; }
        .icon-btn:active { opacity: 0.6; transform: scale(0.9); }

        /* ä¸»ä½“å†…å®¹ï¼šè§£å†³é¢„è§ˆåŒºä¹±ç /é‡å é—®é¢˜ */
        main { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            background: var(--bg);
        }

        /* ç«–å±é«˜åº¦åˆ†é…ï¼šä»£ç  32% | é¢„è§ˆ 68% */
        .editor-section { 
            height: 32%; 
            display: flex; 
            border-bottom: 2px solid var(--border); 
            overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡ºåˆ°é¢„è§ˆåŒº */
            background: var(--bg);
            position: relative;
        }
        .preview-section { 
            height: 68%; 
            background: #fff; 
            overflow: hidden;
        }
        
        /* ç¼–è¾‘å™¨å†…éƒ¨æ ·å¼ */
        .line-num-bar { 
            width: 32px; 
            padding-top: 10px; 
            color: #666; 
            font-size: 11px; 
            text-align: center; 
            background: rgba(0,0,0,0.2); 
            font-family: 'Menlo', 'Monaco', monospace;
            border-right: 1px solid var(--border);
            pointer-events: none;
        }
        textarea { 
            flex: 1; 
            background: transparent; 
            color: #9cdcfe; 
            border: none; 
            padding: 10px; 
            resize: none; 
            outline: none; 
            font-size: 14px; 
            font-family: 'Menlo', 'Monaco', 'Consolas', monospace; 
            line-height: 1.5; 
        }
        iframe { width: 100%; height: 100%; border: none; display: block; }

        /* åº•éƒ¨ï¼šç¡®ä¿å§‹ç»ˆåœ¨å±å¹•å†… */
        footer {
            background: var(--panel); 
            border-top: 1px solid var(--border);
            padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
            flex-shrink: 0;
            z-index: 100;
        }
        .ad-row {
            background: rgba(255,152,0,0.1);
            border: 1px dashed rgba(255,152,0,0.3);
            border-radius: 6px; padding: 6px; margin-bottom: 8px;
            text-align: center;
        }
        .ad-row a { color: var(--warning); text-decoration: none; font-size: 12px; font-weight: bold; }
        .info-row { display: flex; justify-content: center; gap: 18px; font-size: 12px; color: #888; }
        .wx-copy { color: var(--accent); text-decoration: underline; font-weight: bold; cursor: pointer; }

        /* åˆ†äº«å¼¹çª— */
        #shareModal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); z-index: 2000; align-items: center; justify-content: center;
        }
        .modal-content { width: 90%; max-width: 320px; }
        #cardArea { 
            background: #fff; padding: 25px; border-radius: 16px; text-align: center; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        #cardArea h3 { color: #333; font-size: 20px; margin-bottom: 6px; }
        #cardArea p { color: #666; font-size: 13px; margin-bottom: 4px; }
        .qr-box { width: 180px; height: 180px; margin: 15px auto; border: 1px solid #eee; padding: 5px; }
        
        .modal-btns { margin-top: 20px; display: flex; flex-direction: column; gap: 12px; }
        .btn-main { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 10px; font-weight: bold; font-size: 15px; }
        .btn-sub { color: #999; background: none; border: none; font-size: 13px; }

        #toast { position: fixed; top: 45%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.85); color: #fff; padding: 12px 24px; border-radius: 30px; font-size: 14px; z-index: 3000; display: none; }

        /* æ¨ªå±é€‚é… */
        @media (min-width: 769px) {
            main { flex-direction: row; }
            .editor-section { height: 100%; width: 40%; border-bottom: none; border-right: 2px solid var(--border); }
            .preview-section { height: 100%; width: 60%; }
        }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="logo">AIDOUDOU <i>PRO</i></div>
        <div class="nav-icons">
            <button class="icon-btn" onclick="doPaste()"><span>ğŸ“‹</span><label id="l-paste">ç²˜è´´</label></button>
            <button class="icon-btn" onclick="openShare()"><span>ğŸ“¤</span><label id="l-share">åˆ†äº«</label></button>
            <button class="icon-btn" onclick="toggleLang()"><span>ğŸŒ</span><label id="l-lang">ä¸­æ–‡</label></button>
            <button class="icon-btn" onclick="clearCode()"><span>ğŸ—‘ï¸</span><label id="l-clear">æ¸…ç©º</label></button>
            <button class="icon-btn" style="color:var(--primary)" onclick="runCode()"><span>â–¶</span><label id="l-run">è¿è¡Œ</label></button>
        </div>
    </header>

    <main>
        <div class="editor-section">
            <div class="line-num-bar" id="line-nums">1</div>
            <textarea id="editor" spellcheck="false" placeholder="Write code here..."></textarea>
        </div>
        <div class="preview-section">
            <iframe id="preview-frame"></iframe>
        </div>
    </main>

    <footer>
        <div class="ad-row">
            <a href="#" id="ad-text">ğŸ è‰¾å…œå…œå„¿ä¸“å±ï¼šé«˜æ€§èƒ½äº‘æœåŠ¡å™¨ä¼˜æƒ å…¥å£ &gt;</a>
        </div>
        <div class="info-row">
            <span><b id="l-author">ä½œè€…</b>: è‰¾å…œå…œå„¿</span>
            <span onclick="copyWx()">WeChat: <b class="wx-copy">857023577</b></span>
        </div>
    </footer>
</div>

<div id="shareModal">
    <div class="modal-content">
        <div id="cardArea">
            <h3 id="s-title">æ™ºèƒ½ä»£ç è¿è¡Œå™¨</h3>
            <p id="s-sub">ä½œè€…: è‰¾å…œå…œå„¿ | å¾®ä¿¡: 857023577</p>
            <img id="qrImg" class="qr-box" src="" alt="QR">
            <p style="font-size: 11px; color: #aaa;" id="s-hint">æ‰«ç é¢„è§ˆä»£ç ï¼Œå¼€å¯æ™ºèƒ½å¼€å‘</p>
        </div>
        <div class="modal-btns">
            <button class="btn-main" onclick="saveCard()" id="l-save">ä¿å­˜åç‰‡åˆ°ç›¸å†Œ</button>
            <button class="btn-sub" onclick="closeShare()" id="l-close">å…³é—­</button>
        </div>
    </div>
</div>

<div id="toast"></div>

<script>
    const editor = document.getElementById('editor');
    const previewFrame = document.getElementById('preview-frame');
    const lineNums = document.getElementById('line-nums');
    const toast = document.getElementById('toast');

    const i18n = {
        'zh': {
            paste:'ç²˜è´´', share:'åˆ†äº«', clear:'æ¸…ç©º', run:'è¿è¡Œ', lang:'ä¸­æ–‡', save:'ä¿å­˜åç‰‡åˆ°ç›¸å†Œ', close:'å…³é—­',
            author:'ä½œè€…', ad:'ğŸ è‰¾å…œå…œå„¿ä¸“å±ï¼šé«˜æ€§èƒ½äº‘æœåŠ¡å™¨ä¼˜æƒ å…¥å£ >', stitle:'æ™ºèƒ½ä»£ç è¿è¡Œå™¨', hint:'æ‰«ç é¢„è§ˆä»£ç ï¼Œå¼€å¯æ™ºèƒ½å¼€å‘',
            code: `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: system-ui; padding: 20px; color: #333; line-height: 1.6; }
        .card { background: #fdfdfd; padding: 20px; border-radius: 12px; border: 1px solid #eee; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        h2 { color: #4CAF50; margin-top: 0; }
        .tag { display: inline-block; background: #e8f5e9; color: #2e7d32; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="card">
        <h2>ğŸš€ ä½¿ç”¨æŒ‡å— (Instruction)</h2>
        <div><span class="tag">ç²˜è´´ä»£ç </span><span class="tag">å®æ—¶é¢„è§ˆ</span><span class="tag">ç”Ÿæˆåç‰‡</span></div>
        <p>1. åœ¨ä¸Šæ–¹é»‘è‰²åŒºåŸŸè¾“å…¥æˆ–<b>ç²˜è´´</b>æ‚¨çš„ HTML ä»£ç ã€‚<br>2. ç‚¹å‡»å³ä¸Šè§’ <b>è¿è¡Œ</b> æŒ‰é’®æŸ¥çœ‹æ•ˆæœã€‚<br>3. æ»¡æ„åç‚¹å‡» <b>åˆ†äº«</b> å¯¼å‡ºå¸¦æœ‰ä½œå“äºŒç»´ç çš„åç‰‡ã€‚</p>
        <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
        <p><b>ä½œè€…ï¼š</b>è‰¾å…œå…œå„¿ (AiDouDou)</p>
    </div>
</body>
</html>`
        },
        'en': {
            paste:'Paste', share:'Share', clear:'Clear', run:'Run', lang:'English', save:'Save to Album', close:'Close',
            author:'Author', ad:'ğŸ Exclusive: Best Cloud Server Deals for Devs >', stitle:'Code Runner Pro', hint:'Scan QR code to preview my code',
            code: `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: system-ui; padding: 20px; color: #333; line-height: 1.6; }
        .card { background: #fdfdfd; padding: 20px; border-radius: 12px; border: 1px solid #eee; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        h2 { color: #007acc; margin-top: 0; }
        .tag { display: inline-block; background: #e1f5fe; color: #0288d1; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="card">
        <h2>ğŸš€ Getting Started</h2>
        <div><span class="tag">Paste</span><span class="tag">Live Preview</span><span class="tag">Share Card</span></div>
        <p>1. <b>Paste</b> your HTML/CSS code in the editor above.<br>2. Click the <b>Run</b> button to see results.<br>3. Click <b>Share</b> to generate a card with a QR code.</p>
        <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
        <p><b>Author:</b> AiDouDou</p>
    </div>
</body>
</html>`
        }
    };

    let currentLang = 'zh';

    function init() {
        const savedCode = localStorage.getItem('dd_runner_v7');
        currentLang = localStorage.getItem('dd_lang_v7') || 'zh';
        editor.value = savedCode || i18n[currentLang].code;
        updateUI();
        runCode();
        updateLines();
    }

    function toggleLang() {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        localStorage.setItem('dd_lang_v7', currentLang);
        editor.value = i18n[currentLang].code;
        updateUI();
        runCode();
        updateLines();
        showToast(currentLang === 'zh' ? "å·²åˆ‡æ¢è‡³ä¸­æ–‡" : "Switched to English");
    }

    function updateUI() {
        const d = i18n[currentLang];
        document.getElementById('l-paste').innerText = d.paste;
        document.getElementById('l-share').innerText = d.share;
        document.getElementById('l-clear').innerText = d.clear;
        document.getElementById('l-run').innerText = d.run;
        document.getElementById('l-lang').innerText = d.lang;
        document.getElementById('l-save').innerText = d.save;
        document.getElementById('l-close').innerText = d.close;
        document.getElementById('l-author').innerText = d.author;
        document.getElementById('ad-text').innerText = d.ad;
        document.getElementById('s-title').innerText = d.stitle;
        document.getElementById('s-hint').innerText = d.hint;
    }

    function runCode() {
        const doc = previewFrame.contentDocument || previewFrame.contentWindow.document;
        doc.open();
        doc.write('<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">');
        doc.write(editor.value);
        doc.close();
    }

    function openShare() {
        const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(window.location.href)}`;
        document.getElementById('qrImg').src = qrUrl;
        document.getElementById('shareModal').style.display = 'flex';
    }

    function closeShare() { document.getElementById('shareModal').style.display = 'none'; }

    function saveCard() {
        showToast("æ­£åœ¨ç”Ÿæˆé«˜æ¸…å›¾ç‰‡...");
        html2canvas(document.getElementById('cardArea'), { useCORS: true, scale: 2 }).then(canvas => {
            const a = document.createElement('a');
            a.download = 'MyCode-AiDouDou.png';
            a.href = canvas.toDataURL();
            a.click();
            showToast("å›¾ç‰‡å·²å°è¯•ä¸‹è½½");
        });
    }

    async function doPaste() {
        try {
            const text = await navigator.clipboard.readText();
            if(text) { editor.value = text; updateLines(); runCode(); showToast("ç²˜è´´æˆåŠŸ"); }
        } catch(e) { showToast("è¯·æ‰‹åŠ¨é•¿æŒ‰ç²˜è´´"); }
    }

    function clearCode() { editor.value = ''; updateLines(); runCode(); showToast("å·²æ¸…ç©º"); }

    function copyWx() {
        navigator.clipboard.writeText('857023577').then(() => showToast("å¾®ä¿¡å·å·²å¤åˆ¶"));
    }

    function showToast(m) {
        toast.innerText = m; toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', 1600);
    }

    function updateLines() {
        const count = editor.value.split('\n').length;
        let h = ''; for(let i=1; i<=count; i++) h += i + '<br>';
        lineNums.innerHTML = h;
    }

    editor.addEventListener('input', () => {
        updateLines();
        localStorage.setItem('dd_runner_v7', editor.value);
    });

    editor.addEventListener('scroll', () => { lineNums.scrollTop = editor.scrollTop; });

    init();
</script>
</body>
</html>